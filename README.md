<!-- Markdown: Open Preview to the side -->
# aichanweb
## ファイルの中身確認
中に入っているのは以下の通りです。
```
file
  ┗ musubiai2.0
       ┗ PmxView
            ┗ aichan.x (小道具類のファイル)
       ┗ tex (テクスチャファイル)
       ┗ aichan.pmx (ボーンを少しいじった)
       ┗ musubiai.fx (エフェクトとか。)
       ┗ musubiai2.0.pmx (変換してそのまんま)
  ┗ js(スクリプト)
         ┗ main.js 
  ┗ audio(音声 ボイスとかを色々)
         ┗ kei2_voice_009.mp3 
         ┗ kei2_voice_010.mp3
  ┗ vmd(モーション ボイスに絡めたのを色々)
         ┗ kei_voice_009_1.vmd
         ┗ kei_voice_010_2.vmd
         ┗ loop.vmd
         ┗ thinking.vmd
  ┗ index.html(表示 各種JS読み込み)
```
***
## 取り扱い説明
### 1.ネットに繋がってないと見れません。
理由はindex.htmlを見てください。
### 2.派手に動くモーションは無理です。
カメラ位置を固定にしちゃってます。  
なので画角の外から派手に暴れて写ってくるのしか見えません。
### 3.ロリ系モデルを使う場合はカメラをいじること
まず見切れます。なぜならチビだから。   
アイちゃんの身長に合わせたカメラの位置にしてます。  
なのでチビを使うのであればそれに合わせた位置にいじってください  
「どこのどれや！怒」ていう人は下にスクロールしてください。
### 4.もっと早くモデルを表示したい！
vmdに関してはこれで**最速**のはずです。  
ただ、tgaのほうは試してないのでわかりません。  
もっと早くするならtexの中のpng達を軽くするしかないと思いますが、  
やっても0.014秒変わるという誤差の範囲なのでしてません。
***
## 遊び方
### 1.開く前にまずはブラウザ自体のサイズを任意で決めよう
最大でもいいですし、めっちゃ小さくてもいいです。  
とりあえず開いてるブラウザ自体の表示の大きさを好きな大きさにしてください。
### 2.index.htmlを開いてみよう！
ダウンロードしたindex.htmlでもいいですし、[ここから](https://mhiroki-1214.github.io/aichanweb/)でもいいです。  
開いたら次の画像のような画面が表示されると思います。  
![none](gazou/img1.png)
ひとまずモデルが出てきて、首を傾げたりしていたらおkです。
### 3.ポーズを変えてみよう
デフォルトで入ってるものは口パクと首を傾げたりすることしかできないですが、  
それでも動くんやで！っていうのを出してみます。  
次の画像左上に赤色で囲った部分を押してみてください。  
(1:初期状態 2:口パク 3:口パク+首傾げ)
![none](gazou/img2.png)
pose2を押してみます。すると・・・
![none](gazou/img3.png)
口パクを行いました。  
jsをいじると音声が流れます。  
が、機構が上手くいかないので非推奨です。


以上です。  
これだけ？と思うかもしれませんが、  
ここからjsをいじると色々で来ますので解説します。
***
## main.jsをいじって自分好みに仕上げていこう
自分好みとはいっても、モデルはあのモデルがいいな～・・・と思うかもしれません。  
では、好きなモデルに変えてみよう！ということをします。
### モデルの準備 
まずは、好きなモデルを1つどこかから持ってきてください。  
例えば、ここではONEのモデルを使ってみます。  
ダウンロードができたら画像の用に置いてください。
![none](gazou/img4.png)
※仮に、texファイルとpmxがバラバラの場合は1つファイルを作成してその中に入れてください。  
モデルの準備はこれで大丈夫です。
### jsを書き換えてみよう
まずはエディタでmain.jsを開いてみてください。  
開いたら1行目が見える辺りまで上げて置いてください。  
次に、赤い線の部分を書き換えます
![none](gazou/img5.png)
現状は・・・
```
const Pmx = "./pmx/musubiai2.0/aichan.pmx";
```
となっているはずです。  
ここを用意したモデルの.pmxとなっている物に書き換えるだけです。
```
//私の場合は・・・
const Pmx = "./pmx/musubiai2.0/aichan.pmx";
             ↓
const Pmx = "./pmx/ONE_schoolgirl/ONE.pmx";
```
では、これで実行してみましょう。すると・・・
![none](gazou/img6.png)
若干カメラ位置が気になりますが、無事に表示されました！  
ただ、ループのvmdが少し気になったりしますがそれはしょうがないとしてください。
### カメラの位置を好きな位置に変えてみよう！
このカメラは置き型だと思ってください。  
モデルを検知してそこに自動で行くという超便利なものではありません。  
モデルここにくるよね？じゃあここに置きまっせというカメラです。無人です。  
カメラをいじっている文はココです。
![none](gazou/img7.png)
```
camera.position.set(0,17,24);
```
察しのいい方ならお気づきかと思いますが、  
(x軸,y軸,z軸)という感じで設置しています。  
x軸をいじると左右にズレます。  
y軸をいじると上下にズレます。  
z軸は奥行きが変わります。  
これらをいじってモデルが見やすい位置にカメラを移動させてください。  
これでモデル見えない問題は解決します。
***
## モーションをいじってみませんか？？  
モーションはVMDというファイル形式になっています。  
そちらを確認して、あまり**派手に動かないモーション**を入れてください。  
暴れると終わりです。全部ぐちゃぐちゃになっちゃいます。  
入れる場所はvmdフォルダーです。また、.vmdのみ入れてください。
![none](gazou/img8.png)
ここに入れたら次はmain.jsをいじりましょう。  
19行目辺りに次の文が書かれてます。
```
const MotionObjects = [
  { id: "loop", VmdClip: null, AudioClip: false },
  { id: "kei_voice_009_1", VmdClip: null, AudioClip: false },
  { id: "kei_voice_010_2", VmdClip: null, AudioClip: false }
];
```
また、一番下に次の文が書かれてます。
```
PoseClickEvent = (id) => {
  switch (id) {
    case "pose1":
      VmdControl("loop", true);
      break;

    case "pose2":
      VmdControl("kei_voice_009_1", false);
      break;

    case "pose3":
      VmdControl("kei_voice_010_2", false);
      break;

    default:
      VmdControl("loop", true);
      break;
  }
}
```
この共通した部分(loop,kei_voice_009_1,kei_voice_010_2)を書き換えます。  
ここは**同じになるようにしてください**
```
例えば1つ目が
const MotionObjects = [
  { id: "loop", VmdClip: null, AudioClip: false },
となっているのに一番下で
    case "pose1":
      VmdControl("kei_voice_009_1", false);
      break;
となっているとめっちゃおかしくなる
```
こうすることで・・・
![none](gazou/mp4.gif)
ハァイ！！変えれました！！！  
このモーションは最初から入れてあるthinkingというvmdです。  
こんな感じで色々動かせるのでやってみてください。
***
## 最後。
jsとMMDの組み合わせはここ最近安定してきた感じでまさに最先端のjsです。  
これをきっかけに(なるかわからんが)jsのことをもっと学んでみてくださいね。  
また、MMDの利用方法とかも[こちら](https://github.com/mhiroki-1214/mmdaichan)で説明とかしてます。  
色々遊んでみてください！！
